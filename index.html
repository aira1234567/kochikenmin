<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>高知週末イベントマップ</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

<style>
body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: #f2f2f7;
}

header {
    padding: 14px;
    text-align: center;
    font-weight: bold;
    background: white;
    border-bottom: 1px solid #ddd;
}

#map {
    height: calc(100vh - 60px);
}
</style>
</head>
<body>

<header>高知 週末イベントマップ</header>
<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
// 地図
const map = L.map('map').setView([33.5597, 133.5311], 11);

// タイル
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap'
}).addTo(map);

// フォールバック用（最低限のイベント）
const fallbackEvents = [
    { name: "日曜市", lat: 33.559, lng: 133.531, place: "高知市中心部" },
    { name: "ひろめ市場ライブ", lat: 33.5595, lng: 133.5318, place: "ひろめ市場" },
    { name: "桂浜ナイト散策", lat: 33.502, lng: 133.538, place: "桂浜" }
];

// 表示関数
function showEvents(events) {
    events.forEach(e => {
        L.marker([e.lat, e.lng])
        .addTo(map)
        .bindPopup(`<b>${e.name}</b><br>${e.place}`);
    });
}

// JSON取得（GitHub上のevents.json）
fetch('events.json')
.then(res => res.json())
.then(data => {
    showEvents(data);
})
.catch(() => {
    // 取得失敗時
    showEvents(fallbackEvents);
});
</script>

</body>
</html>
